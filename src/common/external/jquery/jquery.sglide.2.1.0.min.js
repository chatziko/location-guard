/*
sGlide is a jQuery plugin that generates a simple, highly flexible, feature-rich & mobile-ready slider.
Copyright (C) 2014  Daniel Kazmer
See <http://www.gnu.org/licenses/gpl.html>

author:		Daniel Kazmer - http://iframework.net
created:	16.11.2012
version:	2.1.0
*/
(function(e){var t={};var n={};var r={destroy:function(){this.each(function(t,r){var i=e(r);var s=i.selector;var o=i.attr("id");var u=e("#"+o+"_vert-marks");if(u[0])i.unwrap();else{var a=e("#"+o+"_button-marks");if(a[0])i.unwrap()}if(e("#"+o+"_plus")[0])e("#"+o+"_minus, #"+o+"_plus").remove();var f=e("#"+o+"_markers");if(f.length>0)f.remove();var l={down:"mousedown",up:"mouseup",move:"mousemove"};if(n[o+"-isMobile"]){l.down="touchstart";l.up="touchend";l.move="touchmove"}else e(document).off("keydown."+o).off("keyup."+o);if(n[o+"-buttons"]){e("#"+o+"_plus").off(l.down).off(l.up);e("#"+o+"_minus").off(l.down).off(l.up)}e(document).off(l.move+"."+o).off(l.up+"."+o);e(window).off("orientationchange."+o);i.off(l.down);i.children(".slider_knob").off(l.up).off(l.down).remove();i.children(".follow_bar").off(l.down).remove();i.removeAttr("style")});return this},startAt:function(r,i){this.each(function(s,o){var u=e(o);var a=u.children(".slider_knob");var f=u.children(".follow_bar");var l=u.attr("id");t[l]=r;var c=u.width();var h=a.width();if(r<=0)r=0;else if(r>=100)r=100;var p=(c-h)*r/100+h/2;var d=p-h/2;if(i){a.animate({left:d+"px"},200);f.animate({width:p+"px"},200)}else{a.css("left",d+"px");f.css("width",p+"px")}if(n[l+"-colorChange"])f[0].children[0].style.opacity=r/100});return this},init:function(r){this.each(function(i,s){var o=e(s);var u=o.attr("id");if(!u){u="sglide-"+i;o.attr("id",u)}o.html('<div class="follow_bar"></div><div class="slider_knob"></div>');var a=o.children(".slider_knob");var f=o.children(".follow_bar");var l=e.extend({startAt:0,image:"none",height:40,width:100,unit:"%",pill:true,snap:{marks:false,type:false,points:0},disabled:false,colorShift:[],vertical:false,showKnob:true,buttons:false,totalRange:[0,0],retina:true},r);o.removeAttr("style");n[u+"-isMobile"]=false;var c={down:"mousedown",up:"mouseup",move:"mousemove"},h=navigator.userAgent;if(h.match(/Android/i)||h.match(/webOS/i)||h.match(/iPhone/i)||h.match(/iPad/i)||h.match(/iPod/i)||h.match(/BlackBerry/i)){n[u+"-isMobile"]=true;c.down="touchstart";c.up="touchend";c.move="touchmove";if(window.navigator.msPointerEnabled){c.down="MSPointerDown";c.up="MSPointerUp";c.move="MSPointerMove"}var p=null,d=null}else if(h.match(/Windows Phone/i)){if(window.navigator.msPointerEnabled){o.css({"-ms-touch-action":"none"});c.down="MSPointerDown";c.up="MSPointerUp";c.move="MSPointerMove"}else{c.down="touchstart";c.up="touchend";c.move="touchmove"}}var v=t[u]=l.startAt,m=0,g=l.vertical,y=l.snap.points>0&&l.snap.points<=9&&l.snap.marks,b=l.snap.type!="hard"&&l.snap.type!="soft"?false:l.snap.type,w="#333",E=l.showKnob&&!l.disabled?"2%":"0",S="inherit",x=Math.round(l.height)+"px",T=l.pill,N=l.image!="none"&&l.image!==""&&!l.disabled,C=false,k=o.attr("data-keys")=="true"?true:false,L=o.attr("data-keys")=="shift"?true:false,A=l.colorShift.length>1?true:false,O=n[u+"-isMobile"],M=(l.totalRange[0]!==0||l.totalRange[1]!==0)&&l.totalRange[0]<l.totalRange[1],_=window.devicePixelRatio>1&&l.retina;n[u+"-buttons"]=l.buttons;n[u+"-colorChange"]=A;if(N){img=l.image;if(_){var D=img.split(".");var P=D.length;D[P-2]=D[P-2]+"@2x";img="";for(var i=0;i<P;i++){img+=D[i]+(i<P-1?".":"")}}a.html('<img src="'+img+'" style="visibility:hidden; position:absolute" />');a.children("img").load(function(){var t=e(this);if(_){t[0].style.width=t[0].offsetWidth/2+"px"}var n=t[0].naturalHeight;E=t[0].naturalWidth+"px";S=n+"px";w="url("+img+") no-repeat";var r={width:E,height:S,background:w};if(_)r["background-size"]="100%";a.css(r);f.css({height:S,"border-radius":T?n/2+"px 0 0 "+n/2+"px":"0"});o.css({height:S,"border-radius":T?n/2+"px":"0"});t.remove();if(n>l.height){var i=0;i=(n-l.height)/2;o.css({height:l.height+"px"});a.css({top:"-"+i+"px"});f.css({height:l.height+"px","border-radius":T?n/2+"px 0 0 "+n/2+"px":"0"})}else{o.css("overflow","hidden");f.find("div").css("height",S)}e(s).trigger(St)})}else{var H=l.height/2;o.css({"border-radius":T?H+"px":"0",overflow:"hidden"});f.css("border-radius",T?H+"px 0 0 "+H+"px":"0");setTimeout(function(){e(s).trigger(St)},0)}var B=l.unit,j=l.width;if(B!="px"&&B!="%")B="%";else if(B=="px")j=Math.round(j);else if(B=="%"&&Math.round(j)>100)j=100;o.css({width:j+B,height:x,"text-align":"left",margin:"auto",cursor:!l.disabled?"pointer":"default","z-index":"997",position:"relative","-webkit-touch-callout":"none"});var F=o.width();var I={"-webkit-box-sizing":"content-box","-khtml-box-sizing":"content-box","-moz-box-sizing":"content-box","-ms-box-sizing":"content-box","box-sizing":"content-box"},q={"-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"},R={"-webkit-transform":"rotate(-90deg)","-khtml-transform":"rotate(-90deg)","-moz-transform":"rotate(-90deg)","-ms-transform":"rotate(-90deg)",transform:"rotate(-90deg)","-webkit-transform-origin":F+"px 0","-khtml-transform-origin":F+"px 0","-moz-transform-origin":F+"px 0","-ms-transform-origin":F+"px 0","transform-origin":F+"px 0",filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)"};o.css(I).css(q);a.css({width:E,background:w,height:S,display:!l.disabled?"inline-block":"none","font-size":"0",position:"relative","z-index":"1"}).css(I);f.css({position:!l.disabled?"absolute":"static",height:a.height()+"px",width:"0"}).css(I);var U=false;var z=Math.round(l.snap.points);var W=[0];var X=function(t){if(z===1)z=2;var n=a.width();var r=F-n;var i=r/(z-1);var s=[0];var f=i;while(f<=r+2){s.push(f);f+=i}i=100/(z-1);f=i;while(f<=101){W.push(f);f+=i}U=true;if(y){var l=null;if(!t){o.after('<div id="'+u+'_markers"></div>');l=e("#"+u+"_markers");l.css({width:F+"px",margin:"auto","padding-left":n/2+"px","-webkit-touch-callout":"none","box-sizing":"border-box"}).css(q)}else{l=e("#"+u+"_markers");l.html("")}var c="";for(var h=0;h<s.length;h++)c+='<div style="display:inline-block; width:0; height:5px; border-left:#333 solid 1px; position:relative; left:'+(s[h]-h)+'px; float:left"></div>';l.html(c)}};var V=function(){if(y&&z>0&&z<10){var t=e("#"+u+", #"+u+"_markers");t.wrapAll('<div id="'+u+'_vert-marks" style="margin:0; z-index:997; width:'+j+B+'; -webkit-backface-visibility:hidden; -moz-backface-visibility:hidden; -ms-backface-visibility:hidden; backface-visibility:hidden"></div>');var n=e("#"+u+"_vert-marks");o.css("width","100%");n.css(I).css(R);for(var r=0;r<t.length;r++)t.css("margin","0")}else{o.css({margin:"0",top:"0",left:"0","backface-visibility":"hidden"}).css(R)}};var J=function(){Y=a.width()/F*50;var t="; z-index:1000; position:relative; top:30px",n='<div class="sglide-buttons" id="'+u+'_plus" style="display:inline-block; cursor:pointer'+(g?t:"")+'">&nbsp;+&nbsp;</div>',r='<div class="sglide-buttons" id="'+u+'_minus" style="display:inline-block; cursor:pointer'+(g?t:"")+'">&nbsp;&minus;&nbsp;</div>';if(y){var i=null;if(!g){o.css("width","auto");var s=g?e("#"+u+"_vert-marks"):e("#"+u+", #"+u+"_markers");s.wrapAll('<div id="'+u+'_button-marks" style="display:inline-block; vertical-align:middle; width:'+j+B+'"></div>');i=e("#"+u+"_button-marks")}else{i=e("#"+u+"_vert-marks")}i.after(n);i.before(r)}else{o.css({display:!g?"inline-block":"block","vertical-align":"middle"});o.after(n);o.before(r)}var f=e("#"+u+"_plus"),h=e("#"+u+"_minus");h.css(q);f.css(q);if(!l.disabled){f.on(c.down,function(){ht(">")}).on(c.up,G);h.on(c.down,function(){ht("<")}).on(c.up,G)}},K=function(e,n){var i=a.width();var s=v=t[u];if(tt){var o=100/(l.snap.points-1);var c=o;for(var h=0;h<l.snap.points;h++){if(o>=v){if(e==">")v=Math.round(o)>Math.round(v)?o:o+c;else v=o-c;break}else o+=c}}else{if(e==">")v+=n?1:10;else v-=n?1:10}s=v;if(v+Y>100){v=100;s=100}else if(v-Y<0){v=0;s=0}var p=(F-i)*s/100+i/2;var d=p-i/2;a.css("left",d+"px");f.css("width",p+"px");if(A)bt({percent:s});if(r.onButton)r.onButton(gt(mt(d)));else t[u]=v},Q=function(e){var t=setInterval(function(){if(Z)K(e,tt?false:true);else clearInterval(t)},tt?201:10)},G=function(){Z=false;clearTimeout(et)},Y=0,Z=false,et=null;var tt=l.snap.points>0&&l.snap.points<=9&&(b=="hard"||b=="soft");var nt=false;a.on(c.down,function(){nt=true;o.data("state","active")}).on(c.up,function(){nt=false});var rt="s-1";var it=function(t,n){if(z>0&&z<10){var r=a.width();var i=F*(10-z)/100-2;var s=[];for(var o=0;o<W.length;o++){s.push((F-r)*W[o]/100)}var u=null,f=0;e.each(s,function(e){if(u===null||Math.abs(this-n)<Math.abs(u-n)){u=this|0;f=W[e]}});if(t=="drag"){if(b=="hard"){ot(u,u+r/2);st(u,f)}else{if(Math.round(Math.abs(u-n))<i){ot(u,u+r/2);st(u,f)}else rt="s-1"}}else if(t=="hard"){ot(u,u+r/2);return u}else{ot(u,u+r/2,true);return u}}},st=function(e,t){if(r.onSnap&&"s"+e!==rt){if(t>100)t=100;rt="s"+e;r.onSnap(gt(mt(e)))}},ot=function(e,t,n){if(!n){a.css("left",e+"px");f.css("width",t+"px")}else{a.animate({left:e+"px"},"fast");f.animate({width:t+"px"},"fast")}};var ut=function(){o.sGlide("startAt",t[u]);if(y)X(true)};if(!O&&(k||L)){var at,ft=false,lt=g?40:37,ct=g?38:39;e(document).on("keydown."+u,function(e){if(!ft&&!l.disabled){if(window.event){at=window.event.keyCode;if(L&&!window.event.shiftKey)return false}else if(e){at=e.which;if(L&&!e.shiftKey)return false}if(at==lt){ht("<");ft=true}else if(at==ct){ht(">");ft=true}}}).on("keyup."+u,function(){ft=false;G()})}var ht=function(e){Z=true;K(e);et=setTimeout(function(){Q(e)},500)};if(O){e(document).on(c.down+"."+u,function(e){p=e.originalEvent.touches[0].pageX;d=e.originalEvent.touches[0].pageY})}if(O||h.match(/Windows Phone/i)){e(window).on("orientationchange."+u,ut)}e(document).on(c.move+"."+u,function(e){if(!nt)return false;e=e||event;var t=null,n=a.width();if(g){var i=o.position().top+F;if(O){d=e.originalEvent.touches[0].pageY;t=i-d}else t=i-e.pageY}else{if(O){p=e.originalEvent.touches[0].pageX;t=p-o.offset().left}else t=e.pageX-o.offset().left}var s=n/2;var u=t-s;if(e.returnValue)e.returnValue=false;if(t<=s){a.css("left","0");f.css("width",s+"px")}else if(t>=F-s){a.css("left",F-n+"px");f.css("width",F-s+"px")}else{a.css("left",t-s+"px");f.css("width",t+"px");if(!b||b=="hard")it("drag",u)}m=a[0].style.left;m=m.replace("px","");var l=o.data("state");if(r.drag&&l=="active")r.drag(gt(mt(m)));if(A&&l=="active")bt(mt(m))}).on(c.up+"."+u,function(e){var t=o.data("state");nt=false;if(t=="active"){e=e||event;var n=null,i=0;if(g){i=o.position().top+F;n=i-((!O?e.pageY:d)-2)}else n=(!O?e.pageX:p)-o.offset().left;var s=a.width();var u=s/2;var f=n-u;if(z>0&&z<10&&(b=="soft"||b=="hard"))m=it(b=="hard"?"hard":"soft",f);if(r.drop)r.drop(gt(mt(m)));if(r.drag&&t=="active")r.drag(gt(mt(m)));o.data("state","inactive");if(A)bt(mt(m))}if(Z)G()});if(M){var pt=l.totalRange[0];var dt=l.totalRange[1]-pt}var vt={};var mt=function(e){var n=0;e=parseFloat(e,10);var r=e/(o[0].offsetWidth-a[0].offsetWidth)*100;r=Math.min(r,100);if(M)n=dt*r/100+pt;v=t[u]=r;vt.percent=r;if(M)vt.custom=n;return vt};var gt=function(e){e.id=u;e.el=o;return e};var yt=function(){var e=o.offsetHeight/2;var t="border-radius: "+(T?e+"px 0 0 "+e+"px":"0");f.css({overflow:"hidden","background-color":l.colorShift[0]});f.html('<div style="opacity:'+l.startAt/100+"; height:100%; background-color:"+l.colorShift[1]+'; "></div>')};var bt=function(e){f[0].children[0].style.opacity=e.percent/100};var wt=function(e){e=e||event;e.stopPropagation();e.preventDefault();if(e.returnValue)e.returnValue=false;nt=true;o.data("state","active");if(!O&&b!="soft"){var t=null;if(g){var n=o.position().top+o.width();t=n-(e.pageY-2)}else t=e.pageX-o.offset().left;var r=t-a.width()/2;a.css("left",r+"px");f.css("width",r+a.width()/2+"px");if(r<0)a.css("left","0");else if(r>=o.width()-a.width())a.css("left",o.width()-a.width()+"px")}};if(!l.disabled){o.on(c.down,wt);f.on(c.down,wt)}var Et=function(i){var a=t[u];var f=gt({percent:a});if(z>0&&z<10)X();if(g)V();if(n[u+"-buttons"])J();if(A)yt();if(r.onload)r.onload(f);o.sGlide("startAt",a);e(s).off("makeready."+u,Et)};var St=e.Event("makeready."+u);e(s).on("makeready."+u,Et)})}};e.fn.sGlide=function(t){if(r[t]){return r[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return r.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.sGlide")}}})(jQuery)